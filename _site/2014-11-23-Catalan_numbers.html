<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Catalan number</title>
    <meta name="description" content="Thinking, coding.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://QAMichaelPeng.github.io/2014-11-23-Catalan_numbers.html">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">QAMichaelPeng</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/2014-11-20-sharepointer_1.html">make a shared_ptr from scratch</a>
          
        
          
          <a class="page-link" href="/2014-11-23-Catalan_numbers.html">Catalan number</a>
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <p>How many ways are there to push and pop n elements into and out a stack? We marked E as push and L as pop, the question can be converted to: how many ways to represent a 2n length string with E and L that in any of its prefixes, numbers of E are no less than numbers of L. If a 2n string composed by E and L can represent a way to push and pop n elements, we call it a good string.</p>

<p>From a 2n string with n E and n L, find first L before which it there’re same Es and Ls.  If we can find such an L, the string doesn’t satisfy conditions above. We named such strings as bad string. </p>

<p>For a bad string, if we flip it after the first L before which there’re same Es and Ls, we got another 2n string composed by n+1 L and n-1 E.</p>

<p>For 2 different bad strings B1 and B2 with different flip position, the flipped strings of them shouldn’t be same. Assume B1’s flip position is p1, B2’s flip position is p2 and p1 &lt; p2(index based 0, and p1 must &gt; 0), then the lenght p1 prefix of blipped strings B1’ and B2’ are keeping unflipped and should be same with the original string. If the original strings have a same length p1 prefix, they should both flip at p1 position. So the prefix with a length p1 of B1 and B2 are different.</p>

<p>For 2 different bad strings B1 and B2 with same flip position p, there must be some different before or after p. No matter where the difference is, the difference part will be clipped or not samely for the two strings. So they keep different afte flip. </p>

<p>So different bad strings got different flipped strings with n+1 L and n-1 E.</p>

<p>Vice visa, for any two different strings that both have n+1 L and n-1 E, we flipped back after the first L that before which there’re same Es and Ls and get a string with same Es and Ls. Since there’re more Ls than Es, we can always find such an L. We can prove similarily that different original strings will get different flipped strings.</p>

<p>So there’s a 1-1 mapping from bad strings with n Es and n Ls to strings with n+1 L and n-1 E. So there’re C(2n, n-1) bad strings.
The good string number is: C(2n, n) - C(2n, n-1) = C(2n, n) / (n+1). This is the famous <a href="http://en.wikipedia.org/wiki/Catalan_number">Catalan number</a>.</p>

<p>Cat(n) = C(2n, n)/(n+1).</p>

<p>Let’s try to get Cat(n) in another way: suppose before we popped k elements out before popping the first element out, for k = 0..n-1, we have</p>

<p>Cat(n) = sum(Cat(k)Cat(n-1-k)) (k=0…n-1)</p>

<p>Example 1: Ways to generate valid parenthesis sequences. Consider left parenthesis as push and right parenthesis as pop.</p>

<p>Example 2: Add parenthesis to expression of N matrix multiply. P(1) = 1, P(2) = P(1) * P(1), P(3) = P(1) * P(2) + P(2) * p(1), P(n) = Cat(n-1)</p>

<p>Example 3: How many different shapes of a n nodes binary tree. T(0) = 1, T(1) = 1, T(2) = T(0) * T(1) + T(1) * T(0) (left from 0 to n-1, right from n-1 to 0), T(n) = Cat(n)</p>

<p>Example 4: 2n points on a circle, how many ways to conect those points to n segments without crossing each other. F(0) = 1, F(1) = 1, F(2) = F(0) * F(1) + F(1) * F(0), F(n) = F(0)* F(n-1) + F(1) * F(n-2) + …  F(n-1) * F(0) = Cat(n) (Select a base point, connect it with a segment to the point that has even points between them, So in the two sides of the segment there’re  2k points and 2n - 2 - 2k points…)</p>

<p>Example 5: Divide a convex polygon to triangles. T(2) = 1, T(3) = T(2)*T(2)=1, T(4) = T(2) * T(3) + T(3) * T(2)= 1, T(5) = T(2) * T(4) + T(3) * T(3) + T(4) * T(2) = Cat(n-2) (Select one side AB, select C from the other n-2 points to get a triangle, so there’s a pologon of k points on the side of AC, k = 2 to n-1, on the side BC, there’s a pologon of n+1-k points(C is the common points of two polygons), T(n)=sum(T(2)T(n-1)+…+T(n-1)T(2))</p>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">QAMichaelPeng</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>QAMichaelPeng</li>
          <li><a href="mailto:Not Available">Not Available</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/QAMichaelPeng">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">QAMichaelPeng</span>
            </a>
          </li>
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Thinking, coding.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
